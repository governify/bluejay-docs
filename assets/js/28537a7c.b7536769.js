"use strict";(self.webpackChunkbluejay_docs=self.webpackChunkbluejay_docs||[]).push([[337],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>k});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,k=u["".concat(s,".").concat(m)]||u[m]||d[m]||a;return n?o.createElement(k,l(l({ref:t},p),{},{components:n})):o.createElement(k,l({ref:t},p))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var c=2;c<a;c++)l[c]=n[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8002:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var o=n(7462),r=(n(7294),n(3905));const a={title:"Docker Compose Local Quickstart",description:"Docker Compose deployed locally",sidebar_position:2,hide_table_of_contents:!1},l="Docker Compose Deployment - Quickstart version",i={unversionedId:"deployment/docker-compose-local-quickstart",id:"deployment/docker-compose-local-quickstart",title:"Docker Compose Local Quickstart",description:"Docker Compose deployed locally",source:"@site/docs/deployment/docker-compose-local-quickstart.md",sourceDirName:"deployment",slug:"/deployment/docker-compose-local-quickstart",permalink:"/deployment/docker-compose-local-quickstart",draft:!1,editUrl:"https://github.com/governify/bluejay-docs/edit/main/docs/deployment/docker-compose-local-quickstart.md",tags:[],version:"current",lastUpdatedBy:"Manuel Otero Barbas\xe1n",lastUpdatedAt:1696200968,formattedLastUpdatedAt:"Oct 1, 2023",sidebarPosition:2,frontMatter:{title:"Docker Compose Local Quickstart",description:"Docker Compose deployed locally",sidebar_position:2,hide_table_of_contents:!1},sidebar:"defaultSidebar",previous:{title:"Docker Compose",permalink:"/deployment/docker-compose"},next:{title:"Kubernetes",permalink:"/deployment/kubernetes"}},s={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"1. Clone Repo",id:"1-clone-repo",level:2},{value:"2. Add &#39;.env&#39; file",id:"2-add-env-file",level:2},{value:"2.1 Create Github token",id:"21-create-github-token",level:3},{value:"3. Create scopes.json",id:"3-create-scopesjson",level:2},{value:"4. Deploy with Docker Compose",id:"4-deploy-with-docker-compose",level:2}],p={toc:c},u="wrapper";function d(e){let{components:t,...a}=e;return(0,r.kt)(u,(0,o.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"docker-compose-deployment---quickstart-version"},"Docker Compose Deployment - Quickstart version"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"This guide deploys bluejay with the docker ecosystem in a local/development environment. For a more advanced deployment please refer to ",(0,r.kt)("a",{parentName:"p",href:"/deployment/docker-compose"},"Docker Compose"),"."),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Windows OS with the following installed packages:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"docker"),(0,r.kt)("li",{parentName:"ul"},"docker-compose (version 1.27 or greater)"))),(0,r.kt)("li",{parentName:"ul"},"Ports 80, 443 open on the server. ")),(0,r.kt)("h2",{id:"1-clone-repo"},"1. Clone Repo"),(0,r.kt)("p",null,"Clone latest release of ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/governify/bluejay-infrastructure"},"Bluejay Infrastructure repository"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"git clone https://github.com/governify/bluejay-infrastructure.git\n")),(0,r.kt)("h2",{id:"2-add-env-file"},"2. Add '.env' file"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file is used to configure environmental variables used in your specific deployment. The content of this file must be the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"# GENERAL (Mandatory for deployment)\n\nGOV_INFRASTRUCTURE=http://host.docker.internal:5200/api/v1/public/infrastructure-local.yaml \n# For service registry\n\nNODE_ENV=development \n# Development environment\n\n\n# Repository branch\nASSETS_REPOSITORY_BRANCH=develop \n# Repository of static files\n\n# Influx database url\nINFLUX_URL=http://host.docker.internal:5002\n\n# Event collector\nKEY_GITHUB=<key> \n# In the section below we will specify how to generate this token\n\n# Frontends access account\nUSER_RENDER=bluejay\nPASS_RENDER=bluejay\nUSER_ASSETS=bluejay\nPASS_ASSETS=bluejay\n# Here you can stablish the credentials to acces Bluejay's frontend\n\n# Assets manager\nKEY_ASSETS_MANAGER_PRIVATE=bluejay-assets-private-key\n# Internal key\n\n# Scope manager\nKEY_SCOPE_MANAGER=bluejay-scopes-private-key\n# Internal key\n\n# Compose config\nCOMPOSE_HTTP_TIMEOUT=200\n")),(0,r.kt)("h3",{id:"21-create-github-token"},"2.1 Create Github token"),(0,r.kt)("p",null,"Generating a Github token is an essential step. With this key Blujay is able to communicate with the app to retrieve information about the repository that you want to audit. This token is not generated in any specific repo, it serves as a personal private API key in your account."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Navigate to your github account and then go to  ",(0,r.kt)("inlineCode",{parentName:"li"},"Settings>Developer Settings")," (at the end of the menu)."),(0,r.kt)("li",{parentName:"ul"},"Go to ",(0,r.kt)("inlineCode",{parentName:"li"},"Personal access tokens > Tokens (classic)")),(0,r.kt)("li",{parentName:"ul"},"Click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Generate new token > Generate new token (classic)")," "),(0,r.kt)("li",{parentName:"ul"},"The scopes you select are up to you, but you need at least repository access."),(0,r.kt)("li",{parentName:"ul"},"Click on ",(0,r.kt)("inlineCode",{parentName:"li"},"Generate token")," and make sure to copy the given key and paste it into ",(0,r.kt)("inlineCode",{parentName:"li"},"KEY_GITHUB")," in the ",(0,r.kt)("inlineCode",{parentName:"li"},".env")," file.")),(0,r.kt)("h2",{id:"3-create-scopesjson"},"3. Create scopes.json"),(0,r.kt)("p",null,"Within the ",(0,r.kt)("inlineCode",{parentName:"p"},"assets/private/scope-manager")," directory, you will discover a file named ",(0,r.kt)("inlineCode",{parentName:"p"},"scopes.json.example"),". This file serves as a blueprint, guiding us in the creation of our custom ",(0,r.kt)("inlineCode",{parentName:"p"},"scopes.json"),", which will be located within the same directory as the example. You can copy the following contents into your scopes file as a test."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "development": [\n        {\n            "classId": "test",\n            "identities": [],\n            "credentials": [],\n            "projects": [\n                {\n                    "name": "Bluejay test",\n                    "projectId": "project01",\n                    "owner": "governify",\n                    "identities": [\n                        {\n                            "source": "github",\n                            "repository": "bluejay-infrastructure",\n                            "repoOwner": "governify"\n                        }\n                    ],\n                    "members": [\n                        {\n                            "memberId": 1,\n                            "identities": [\n                                {\n                                    "source": "github",\n                                    "username": "<YourGHname>"\n                                }\n                            ],\n                            "credentials": []\n                        }\n                    ],\n                    "credentials": []\n                }\n            ]\n        }\n    ]\n}\n')),(0,r.kt)("p",null,"If you modify this file to add more projects or make any change, you will have to restart the ",(0,r.kt)("inlineCode",{parentName:"p"},"render")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"scope-manager")," containers."),(0,r.kt)("h2",{id:"4-deploy-with-docker-compose"},"4. Deploy with Docker Compose"),(0,r.kt)("p",null,"Now we can deploy the system with the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker-compose -f docker-bluejay/docker-compose-local.yaml --env-file .env up -d \n")),(0,r.kt)("p",null,"Navigate to localhost:5100 to access the main page of Bluejay. A prompt like the following will pop up in your browser, where have to input the ",(0,r.kt)("inlineCode",{parentName:"p"},"USER_RENDER")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"PASS_RENDER")," values specified in the ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file:\n",(0,r.kt)("img",{alt:"Login",src:n(9322).Z,width:"395",height:"278"}),"\n",(0,r.kt)("img",{alt:"BJ",src:n(8296).Z,width:"1465",height:"797"})),(0,r.kt)("p",null,"Governify ecosystem with bluejay services should have been deployed in your machine."),(0,r.kt)("p",null,"To stop the containers use:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose -f docker-bluejay/docker-compose-local.yaml --env-file .env stop\n")),(0,r.kt)("p",null,"You can easily restart them using:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose -f docker-bluejay/docker-compose-local.yaml --env-file .env start\n")),(0,r.kt)("p",null,"If you made a change in the configuration you will have to re-compose the containers using ",(0,r.kt)("inlineCode",{parentName:"p"},"down"),"and then using ",(0,r.kt)("inlineCode",{parentName:"p"},"up")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"up -d")," again:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker-compose -f docker-bluejay/docker-compose-local.yaml --env-file .env down # stop and remove containers\n\ndocker-compose -f docker-bluejay/docker-compose-local.yaml --env-file .env up -d # deploy\n")))}d.isMDXComponent=!0},9322:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/login-render-f0e0d06929064c7faa96ee3411493789.png"},8296:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/render-bluejay-0c105eedbb4d0f84109054caf6c7d332.png"}}]);